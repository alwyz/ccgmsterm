SHOCOL .BYT 7,7SHOCUR JSR POSNAM LDA #5 STA COLBBS LDA #146 STA CURBBS LDY #2 LDA (NLOCAT),Y BNE SHOCRP LDA #<NONTXT LDY #>NONTXT JSR OUTSTR JMP SHOCR0SHOCRP JSR PRTCURSHOCR0 LDA #7 STA 211 LDY #20SHOCR1 LDA (NLOCAT),Y BEQ SHOCR2 JSR CHROUT INY CPY #52 BCC SHOCR1SHOCR2  LDA #' ' LDX 211 CPX #39 BCS SHOCR3 JSR CHROUT BNE SHOCR2SHOCR3 LDA #7 STA SHOCOL STA SHOCOL+1SHOBAU LDA #23 STA 214 LDA #$0D JSR CHROUT LDA #7 STA 211 LDA SHOCOL STA 646 LDY #1 LDA (NLOCAT),Y AND #7 ASL A TAY LDX BPSSPD,Y LDA BPSSPD+1,Y JSR OUTNUM LDA #' ' JSR CHROUT LDA #19 STA 211 LDA SHOCOL+1 STA 646 LDY #1 LDA (NLOCAT),Y AND #$80 BNE SHASCT LDA #<GFXBBS LDY #>GFXBBS BNE SHOTTYSHASCT LDA #<ASCBBS LDY #>ASCBBSSHOTTY JSR OUTSTR LDA #34 STA 211 LDA #7 STA 646 LDX TRYCNT LDA #0 JSR OUTNUM LDA #<CURBT2 LDY #>CURBT2 JSR OUTSTR LDA #19 JMP CHROUT;XORALL LDA #0 STA CURPIKXORAL2 JSR XORENT INC CURPIK LDA CURPIK CMP #30 BCC XORAL2 RTSXORENT JSR PHNPTR LDY #2 LDA (NLOCAT),Y BNE XORTOGXORABT RTSXORTOG LDY #0 LDA (NLOCAT),Y EOR #$01 STA (NLOCAT),Y RTS;NEWENT JSR POSNAM LDX #18 LDA #0 JSR INPSET LDY #2 LDA (NLOCAT),Y BNE NEWEN2 DEY LDA BAUTMP STA (NLOCAT),Y LDA GRATMP LSR A ROR A ORA (NLOCAT),Y STA (NLOCAT),Y LDA #<CLRLNT LDY #>CLRLNT JSR OUTSTR JMP NEWEN4NEWEN2 LDY #17NEWENL LDA NAMBBS,Y CMP #' ' BNE NEWEN3 DEY BPL NEWENLNEWEN3 INY TYA CLC ADC 211 STA 211NEWEN4 LDA #1 STA 646 JSR INPUTL LDA #0 STA INPBUF,X CPX #0 BNE NEWEOKNEWUGH JMP ZERENTNEWEOK LDA INPBUF CMP #' ' BEQ NEWUGH LDY #19 LDA #' 'NEWEN5  STA (NLOCAT),Y DEY CPY #1 BNE NEWEN5 INY LDA INPBUF STA (NLOCAT),Y LDX #0 LDY #2NEWEN6 LDA INPBUF,X BEQ NEWEN7 STA (NLOCAT),Y INY INX CPX #18 BCC NEWEN6NEWEN7 LDA #$0D JSR CHROUT LDA #7 STA 211 LDA #0 LDX #32 JSR INPSET LDY #20NEWEN8 LDA (NLOCAT),Y BEQ NEWEN9 INY CPY #52 BCC NEWEN8NEWEN9 TYA SEC SBC #20 CLC ADC 211 STA 211 JSR INPUTL LDA #0 STA INPBUF,X CPX #0 BNE NEWPOK LDY #2 STA (NLOCAT),Y JMP NEWENTNEWPOK TAX LDY #20NEWENA  LDA INPBUF,X STA (NLOCAT),Y BEQ NEWENB INY INX CPY #52 BCC NEWENANEWENB LDA #<HP1MSG LDY #>HP1MSG JSR PRTSTT LDA #7 STA TMPMAX LDY #1 LDA (NLOCAT),Y AND #7 STA TMPOPTNEWENC LDA #1 STA SHOCOL LDA #7 STA SHOCOL+1 JSR SHOBAU JSR NEWSEL BCC NEWENE LDY #1 LDA (NLOCAT),Y AND #$80 ORA TMPOPT STA (NLOCAT),Y JMP NEWENCNEWENE LDA #2 STA TMPMAX LDY #1 LDA (NLOCAT),Y AND #$80 ASL A ROL A STA TMPOPTNEWENF LDA #7 STA SHOCOL LDA #1 STA SHOCOL+1 JSR SHOBAU JSR NEWSEL BCC NEWENG LDY #1 LDA TMPOPT LSR A ROR A AND #$80 STA TMPTMP LDA (NLOCAT),Y AND #7 ORA TMPTMP STA (NLOCAT),Y JMP NEWENFNEWENG LDA #<STATTX LDY #>STATTX JMP OUTSTRZERENT LDY #51 LDA #0ZEREN2  STA (NLOCAT),Y DEY BPL ZEREN2 RTS;TMPOPT .BYT 00TMPMAX .BYT 00TMPTMP .BYT 00NEWSEL JSR GETIN CMP #'+' BNE NEWSL2 INC TMPOPT LDA TMPOPT CMP TMPMAX BCC NEWSL1 LDA #0 STA TMPMAXNEWSL1 SEC RTSNEWSL2 CMP #'-' BNE NEWSL3 DEC TMPOPT BPL NEWSL1 LDX TMPMAX DEX STX TMPOPT SEC RTSNEWSL3 CMP #$0D BNE NEWSEL CLC RTS;PHBOOK LDA #$93 JSR CHROUT JSR PHINITPHLOOP LDA #0 STA TRYCNT LDA BAUTMP STA BAUDRT LDA GRATMP STA GRASFL LDA HILCOL STA COLBBS JSR HILCUR JSR SHOCURPHBGET JSR GETIN CMP #$00 BEQ PHBGET CMP #157  ;LEFT BNE PHB2 LDA CURPIK SBC #15 BCS PHNUPD ADC #30 JMP PHNUPDPHB2  CMP #29 ;RIGHT BNE PHB3 LDA CURPIK CLC ADC #15 CMP #30 BCC PHNUPD SBC #30 JMP PHNUPDPHB3  CMP #145 ;UP BNE PHB4 LDA CURPIK SBC #1 BCS PHNUPD ADC #30 JMP PHNUPDPHB4  CMP #17  ;DOWN BNE PHB5 LDA CURPIK CLC ADC #1 CMP #30 BCC PHNUPD SBC #30PHNUPD PHA LDA ENTCOL STA COLBBS JSR HILCUR PLA STA CURPIK JMP PHLOOPPHB5 CMP #19 BNE PHB6PHBHOM  LDA #0 BEQ PHNUPDPHB6 CMP #$93 BNE PHB7 JSR CLRENT JSR PHINIT JMP PHLOOPPHB7 AND #$7F CMP #'X' BNE PHB8 JSR BAUD JMP F7PHB8 CMP #' ' BEQ PHNSEL CMP #$0D BNE PHB9PHNSEL  LDY #2 LDA (NLOCAT),Y BNE PHNTOGPHABRT JMP PHBGETPHNTOG LDY #0 LDA (NLOCAT),Y EOR #$01 STA (NLOCAT),Y JMP PHLOOPPHB9  CMP #'R' BNE PHB10 JSR XORALL JSR PHINIT JMP PHLOOPPHB10 CMP #'E' BNE PHB11 JSR NEWENT JMP PHLOOPPHB11 CMP #'C' BNE PHB12 JMP DIALTSPHB12 CMP #'A' BNE PHB13 JMP DALSELPHB13 CMP #'D' BNE PHB14 JMP DALUNLPHB14 JMP PHBGET;DIALTS LDA #0 STA DALTYP LDA #<CALCTX LDY #>CALCTX JSR PRTSTT;DIALCR JSR PHNPTR LDY #20DIALC1 LDA (NLOCAT),Y BEQ DIALC2 STA NUMBUF-20,Y INY CPY #52 BCC DIALC1DIALC2 LDA #$0D STA NUMBUF-20,Y LDA NUMBUF CMP #$0D BNE DIALC3 LDA #0 STA WHAHAP JMP DALFINDIALC3 LDY #1 LDA (NLOCAT),Y AND #7 STA BAUDRT JSR BAUD LDY #1 LDA (NLOCAT),Y AND #$80 ASL A ROL A STA GRASFL JMP DIAL;DALFIN LDA WHAHAP CMP #1 BNE DALF2    ;CONNECTED LDA #<CONNTX LDY #>CONNTX JSR PRTSTT LDA #$E0 STA $A2DALFCL  LDA $A2 BNE DALFCL LDA #$0F STA $D418 LDA TRYCNT CMP #4 BCC DALFC1 JSR GONG JMP TERMDALFC1 JSR BELL JMP TERMDALF2 CMP #2      ;ABORTED BNE DALF3 JMP DALFABDALF3 CMP #0 BNE DALF4 LDA DALTYP  ;NO CONNECT CMP #2 BCS DALSLC LDA NUMBUF CMP #$0D BNE DALAG JMP DLABRTDALAG JMP ADNUM   ;REDIAL FOR CURR/UNLDALSLC LDA MOTYPE CMP #5 BCS DALSL0 LDA #<STATTX LDY #>STATTX JSR OUTSTR JMP DALSL0DALSEL  ;DIAL SELECTED LDA #0 STA TRYCNT LDA #<DALSTX LDY #>DALSTX JSR PRTSTTDALSL0 LDA #2 STA DALTYP LDA CURPIK STA TMPPIK LDA ENTCOL STA COLBBS JSR HILCUR LDA TRYCNT BEQ DALSL3DALSL1 INC CURPIK LDA CURPIK CMP #30 BCC DALSL2 LDA #0 STA CURPIKDALSL2 CMP TMPPIK BNE DALSL3 JMP DLABRTDALSL3 JSR PHNPTR LDY #0 LDA (NLOCAT),Y BEQ DALSL1 LDA HILCOL STA COLBBS JSR HILCUR JSR SHOCUR JMP DIALCRDALF4  ;1660-RESULT INDETERMINATE JMP RDTBEG;DALFAB LDA #<STATTX LDY #>STATTX JSR OUTSTR JMP PHLOOPDEFSTD .BYT 0DEFSTF .BYT 6;DALUNL LDA #1 STA DALTYP LDA ENTCOL STA COLBBS JSR HILCUR LDA #<DULSTX LDY #>DULSTX JSR PRTSTT LDA GRASFL BEQ DALUN1 LDA #$80DALUN1  STA DEFSTF LDA BAUDRT ORA DEFSTF STA DEFSTF LDA #<DEFSTD STA NLOCAT LDA #>DEFSTD STA NLOCAT+1 JSR SHOCR3 LDA #<CLRLNT LDY #>CLRLNT JSR OUTSTR LDA #<UNLSTX LDY #>UNLSTX JSR OUTSTR LDY #31 LDA #' 'DALUN2 STA 1951,Y DEY BPL DALUN2 LDA #7 STA 211 AND #0 LDX #32 JSR INPUT BNE DALUN3 JMP DLABRTDALUN3 LDA #$0D STA INPBUF,XDALUN4  LDA INPBUF,X STA NUMBUF,X DEX BPL DALUN4 JMP DIAL;CALCTX .BYT C,'ALL ',C,'URRENT ',N,'UMBER...',0DALSTX .BYT D,'IAL ',CS,'ELECTED ',N,'UMBERS...',0DULSTX .BYT D,'IAL ',U,'NLISTED ',N,'UMBER.',0UNLSTX .BYT U,'NLISTED.',13,0DALTXT .BYT D,'IALING...',0WCRTXT .BYT W,'AITING FOR CARRIER...',0PABTXT .BYT D,'IALING...  ',CP,'RESS ',CS,T,O,CP,' TO ABORT.',0RDTTXT .BYT 32,CR,'EDIAL, ',T,'ERMINAL, OR ',CA,'BORT? ',0NUMBUF.BYT 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0NUMPTR .BYT 0TTFLAG .BYT 0NUMTMP .BYT 0TRYCNT .BYT 0 ;HOW MANY TRIES?DALTYP .BYT 0 ;0=CURR, 1=UNLISTED              ;2=SELECTEDWHAHAP .BYT 0 ;STATUS AFTER CALL;0=BUSY/NO CARRIER, 1=CONNECT;2=ABORTED W/STOP , 3=DUNNO(1660);;MAIN BODY OF DIALERDIALADNUM LDA DATDIR    ;SET UP MODEM HERE ORA #$20 STA DATDIR LDA MOPO2     ;HANG UP MODEM STA MODREG; LDA #$0D JSR CHROUT LDA MOTYPE CMP #$05 BCS AWAIT0AWAIT0 LDA #$96      ;1.75 SEC DELAY STA $A2AWAIT1 JSR GETIN    ;CHECK R/S CMP #$03 BNE AWAITL JMP DLABRTAWAITL LDA $A2 BNE AWAIT1ADBEGN LDA MOPO1      ;PICK UP PHONE STA MODREG LDA #$88       ;2 SEC DELAY STA $A2        ;FOR DIAL TONEAWAIT2 LDA $A2 BNE AWAIT2 INC TRYCNT JSR SHOCR3DIALIN LDY #31 LDA #1DLWHTL STA 56223,Y DEY BPL DLWHTL LDA MOTYPE CMP #$04 BCS DIALN2 CMP #$02 BCC DIALN2 LDA TONPUL BEQ DIALN2 LDA #$0F STA $D418 LDA #$10 STA $D404 STA $D40B LDA #$00 STA $D405 STA $D40C STA $D417 LDA #$F0 STA $D406 STA $D40D BNE DLINITDIALN2 LDA #<PABTXT  ;PRINT STOP ABORTS LDY #>PABTXT  ;IF NOT TONE DIAL JSR PRTSTT JMP DLINI2DLINIT LDA #<DALTXT  ;PRINT 'DIALING: LDY #>DALTXT JSR PRTSTTDLINI2 LDX #$00 STX NUMPTR LDA MOTYPE CMP #$05 BCC DLGETN JMP SMRTDLDLGETN LDX NUMPTR LDA NUMBUF,X  ;GET NUMBER CMP #$0D BNE DLPRNT JMP DLENDDLPRNT INX STX NUMPTR    ;STORE X POINTER PHA LDA #14  ;LT. BLUE STA 56222,X PLA CMP #'-' BNE DLDASH JMP DLGETNDLDASH JSR CALDIG STA NUMTMP CMP #$00 BNE DLTPC LDA #$B0 STA $A2DLPAUS         ;PAUSE CHAR THEN LDA $A2       ;NEXT DIGIT BNE DLPAUS JMP DLGETNDLTPC LDX TONPUL    ;TONE OR PULSE? BEQ PLSDAL    ;(IF TONE, MUST BE LDX MOTYPE    ; A 1660) CPX #$02 BCC PLSDAL CPX #$04 BCS PLSDAL JMP TONEDLPLSDAL CMP #$0B BCC DLDIGT JMP DLGETNDLDIGT LDA #$00 STA TONPUL LDA MOPO4     ;SET UP MODEM STA MODREG    ;FOR CLICK TOGGLE LDA #$FD STA $A2DLWAT1         ;2/60 SEC DELAY LDA $A2 BNE DLWAT1 LDA MOPO3     ;CLICK TOGGLE STA MODREG LDA #$FD STA $A2DLWAT2         ;2/60 SEC DELAY LDA $A2 BNE DLWAT2 DEC NUMTMP    ;DECREMENT NUMBER BNE DLDIGT    ;THROUGH YET? LDA #$F0 STA $A2DLWAT3         ;IF SO, 1/6 SEC LDA $A2       ;DELAY. BNE DLWAT3; JSR GETIN     ;CHECK FOR R/S CMP #$03      ;KEY TO ABORT BNE DLCONT JMP DLABRTDLCONT JMP DLGETN     ;GET NEXT NUMBERDLEND LDA #$0D JSR CHROUT LDA MOTYPE CMP #$02       ;DON'T WAIT FOR BNE CARRWT     ;CARRIER IF 1660 JMP RT1660     ;W/O CAR.DET.CARRWT LDA #<WCRTXT   ;PRINT 'WAITING.. LDY #>WCRTXT JSR PRTSTTDLLSTN LDA #$00 STA $A1 STA $A2CRWAIT LDA MODREG      ;CHECK FOR DCD AND #$10 BEQ CARGOT JSR GETIN CMP #$03 BEQ DLABRT LDA $A1 CMP #$01 BNE CRWAIT LDA $A2 CMP #180 BCC CRWAITCARRED JMP REDIAL     ;GO TO DIAL AGAINCARGOT LDA MOTYPE CMP #$04       ;IF 1064, TELL BNE CARGT2     ;IT TO SEND A LDA #$FF       ;CARRIER STA MODREGCARGT2 LDA $A2 CLC ADC #$84 STA $A3CARCHK LDA MODREG     ;CHECK FOR DCD AND #$10       ;AGAIN BNE CRWAIT LDA $A2 CMP $A3 BNE CARCHK LDA #1         ;GOT CARRIER! STA WHAHAP     ;SET FLAG JMP DALFINDLABRT LDA #$20       ;ABORTED W/STOP! STA DATDIR LDA MOPO2      ;HANG UP MODEM STA MODREG LDA #$D0 STA $A2        ;SHORT DELAYDLABLP LDA $A2 BNE DLABLP     ;BACK TO PHBOOKDGOBAK LDA #2 STA WHAHAP JMP DALFINREDIAL LDA MOPO2      ;HANG UP STA MODREG LDA #$80 STA $A2RDDEL1          ;2 SECOND DELAY LDA $A2        ;BEFORE RESTART BNE RDDEL1RGOBAK LDA #0 STA WHAHAP     ;SET REDIAL FLAG JMP DALFIN     ;BACK TO PHBOOK;;TONE DIAL FOR 1660TONEDL TAXTONIN CMP #$04 BCC TONOUT SBC #$03 BCS TONINTONOUT ASL A TAY LDA TONCOL-2,Y STA $D400 LDA TONCOL-1,Y STA $D401 TXA CLC ADC #$02 LDY #$FF SECTONRW1 SBC #$03 INY BCS TONRW1 TYA ASL A TAY LDA TONROW-2,Y STA $D407 LDA TONROW-1,Y STA $D408 LDA #$11 STA $D404 STA $D40B LDA #$FD STA $A2TONTML LDA $A2 BNE TONTML STA $D404 STA $D40B LDA #$FC STA $A2TONTM2 LDA $A2 BNE TONTM2 JMP DLGETN;;ROW AND COL FREQ'S FOR TONE DIALTONROW .BYT 168,44,85,49,150,54,74,60TONCOL .BYT 117,77,152,85,161,94;CALDIG    ;CONVERT ASCII ALPHA- AND #$7F ;NUMERC TO T.T. VALUE CMP #'1' BCS CALD4 CMP #'0' BNE CALD2 LDX MOTYPE CPX #$03 BEQ CALDD LDA #$0A RTSCALDD LDA #$0B RTSCALD2 CMP #'*' BNE CALD3 LDA #10 RTSCALD3 CMP #'#' BNE CALDER LDA #12 RTSCALDER AND #$00 RTSCALD4 CMP #':' BCS CALD5 AND #$0F RTSCALD5 CMP #'A' BCC CALDER CMP #'Z' BCS CALDER CMP #'Q' BEQ CALDER BCC CALD6 SBC #$01CALD6 AND #$3F CLC ADC #$02 LDY #$00 SECCALD7 SBC #$03 INY BCS CALD7 TYA RTSRT1660  ;1660 PROMPT ROUT. LDA #3 STA WHAHAP JMP DALFIN  ;TEMP BYPASSRDTBEG LDA #<STATTX LDY #>STATTX JSR OUTSTR LDA #<RDTTXT LDY #>RDTTXT JSR OUTSTRRDTLOP JSR GETIN AND #$7F CMP #'A' BNE RDTL1 ORA #$80 JSR CHROUT JMP DGOBAKRDTL1 CMP #'R' BNE RDTL2 ORA #$80 JSR CHROUT JMP RGOBAKRDTL2 CMP #'T' BEQ RDTL3 CMP #$0D BNE RDTLOPRDTL3 JMP TERM;OUTMOD JSR OUTSTROUTMO1  LDA #$E0 STA $A2OUTMO2  LDA $A2 BNE OUTMO2 RTS;PNPTXT .BYT '%E',0PRPTXT .BYT '%F',0PYDTXT .BYT '%D',0ATDTXT .BYT 'ATDT ',0ATPTXT .BYT 'ATDP ',0PRETXT .BYT 'ATE0',13,0PR2TXT .BYT 'ATM0',13,0PR3TXT .BYT 'ATV1',13,0BUSTXT .BYT B,'USY.',0NANTXT .BYT N,'O CARRIER.',0CONNTX .BYT C,'ONNECT!',0TDELAY .BYT 00SMRTDL LDA MOTYPE SEC SBC #$02    ;TDELAY FOR $A1: AND #$07    ;03 FOR 1670 ASL A       ;06 FOR PARADYNE STA TDELAY LDX #$00SMRTD2  LDA NUMBUF,X CMP #$0D BEQ HAYDAL CMP #',' BEQ SMRTD4 CMP #'W' BEQ SMRTD4SMRTD3  INX BNE SMRTD2 BEQ HAYDALSMRTD4  INC TDELAY BNE SMRTD3HAYDAL      ;HAYES/PARADYNE DIAL TXA LSR A ;ADD LENGTH OF #/8 LSR A ;TO TDELAY LSR A CLC ADC TDELAY STA TDELAY LDX TONPUL BNE HAYDOO CLC       ;ADD 20 SECS IF PULSE ADC #5 STA TDELAYHAYDOO LDA MOTYPE CMP #$06   ;PARADYNE MODEM? BCC HAYDA0 ;NOPEPARDA1 LDX #$05 JSR CHKOUT LDA #<PRPTXT LDY #>PRPTXT JSR OUTMOD LDA #' ' JSR CHROUT LDA #'4' JSR CHROUT LDA #$0D JSR CHROUT JSR OUTMO1 LDA #<PNPTXT LDY #>PNPTXT JSR OUTMOD LDA #' ' JSR CHROUT LDA #'1' JSR CHROUT LDA #$0D JSR CHROUT JSR OUTMO1 LDA #<PYDTXT LDY #>PYDTXT JSR OUTMOD LDA #' ' JSR CHROUT LDA TONPUL BNE PARDA2 LDA #'I' JSR CHROUTPARDA2 JMP HAYDASHAYDA0 LDA BAUDRT CMP #$07    ;2400 BAUD? BNE HAYDAB LDA #$06    ;GO TO 1200 TO JSR BAUDST  ;SEND COMMANDSHAYDAB LDX #$05 JSR CHKOUT LDA #<PRETXT LDY #>PRETXT JSR OUTMOD LDA #<PR2TXT LDY #>PR2TXT JSR OUTMOD LDA #<PR3TXT LDY #>PR3TXT JSR OUTMOD JSR BAUD   ;BACK TO RIGHT BAUD LDA TONPUL BEQ HAYDA2 LDA #<ATDTXT LDY #>ATDTXT BNE HAYDA3HAYDA2  LDA #<ATPTXT LDY #>ATPTXTHAYDA3  JSR OUTSTRHAYDAS  LDX #$00HAYDA4  STX NUMPTR JSR CLRCHN LDX NUMPTR LDA #14 STA 56223,X LDX #$05 JSR CHKOUT LDX NUMPTR LDA NUMBUF,X JSR CHROUT INX CMP #$0D BNE HAYDA4 JSR CLRCHN LDA 667      ;CLEAR MODINPUT BUF STA 668 LDA #$E0 LDX MOTYPE CPX #$05 BEQ HAYDAP LDA #$A0HAYDAP  STA $A2 LDA $A2HAYDA5 LDA $A2 BNE HAYDA5 LDA 667      ;CLEAR MODINPUT BUF STA 668 LDA #$00 STA $A1 STA $A2HAYDA6  LDX #$05 JSR CHKIN JSR GETIN AND #$5F CMP #'U'    ;"B<U>SY" BEQ HAYBAK CMP #'N'    ;"<N>O CARRIER" BEQ HAYNAN CMP #'C'    ;"<C>ONNECT" BEQ HAYCON JSR CLRCHN JSR GETIN CMP #$03    ;RUN/STOP BNE HAYDA7 LDX #$05 JSR CHKOUT LDA #$0D JSR CHROUT JSR CLRCHN LDA 667 LDA 668 JMP DLABRTHAYDA7 LDA $A1 CMP TDELAY BCC HAYDA6HAYDA8 LDA $A2 CMP #$90 BCC HAYDA6 LDX #$05 JSR CHKOUT LDA #$0D JSR CHROUT JSR CHROUTHAYNAN JSR CLRCHN LDA #<NANTXT LDY #>NANTXT JSR PRTSTT JMP HAYBK2HAYBAK JSR CLRCHN LDA #<BUSTXT LDY #>BUSTXT JSR PRTSTTHAYBK2 LDA #$C8 STA $A2HAYBK3  LDA $A2 BNE HAYBK3 JSR HAYDEL JMP REDIALHAYCON  JSR HAYDEL LDA #1     ;SET CONNECT FLAG STA WHAHAP JMP DALFINHAYDEL LDA #$E8 STA $A2 LDX #$05 JSR CHKINHAYDLL  JSR GETIN CMP #$0D BEQ HAYDLO LDA $A2 BNE HAYDLLHAYDLO  LDA 667 STA 668 JSR CLRCHN RTS;LOSVCO LDA #<SVCTXT LDY #>SVCTXT LDX #16 JSR INPSET LDA #<CONFFN LDY #>CONFFN JSR OUTSTR JSR INPUTL BEQ LOSVEX TXA LDX #<INPBUF LDY #>INPBUF JSR SETNAM LDA #2 LDX DISKDV LDY #0 JSR SETLFS LDX $B7LOSVEX RTSSVCONF JSR LOSVCO BNE SVCON2 RTSSVCON2 LDX #15 JSR CHKOUT LDX #0SVCON3 LDA SCRACF,X BEQ SVCON4 JSR CHROUT INX BNE SVCON3SVCON4 LDX #0SVCON5  LDA INPBUF,X JSR CHROUT INX CPX MAX BCC SVCON5 LDA #$0D JSR CHROUT JSR CLRCHN LDA #<CONFIG STA NLOCAT LDA #>CONFIG STA NLOCAT+1 LDA #NLOCAT LDX #<ENDSAV LDY #>ENDSAV JSR $FFD8 JSR LOSVERLOSVAB RTSLOCONF JSR LOSVCO BEQ LOSVABLOADCF LDX #<CONFIG LDY #>CONFIG LDA #0  ;LOAD JSR $FFD5 JSR LOSVER JSR SELMDM JSR BAUD RTSLOSVER LDX #15 JSR CHKINLOSVE2  JSR GETIN CMP #$0D BNE LOSVE2 JMP CLRCHN;SELMDM LDA MOTYPE BNE SELMD2MD1650 LDA #$00 STA MOTYPEMOSTRD     ;SUPPOSEDLY STANDARD LDA #$20  ;SETTINGS STA MOPO1 STA MOPO3 LDA #$00 STA MOPO2 STA MOPO4 RTSSELMD2 CMP #$01 BNE SELMD3MHESII LDA #$01 STA MOTYPE LDA #$00 STA MOPO1 LDA #$26 STA MOPO2 LDA #$02 STA MOPO3 LDA #$32 STA MOPO4 RTSSELMD3 CMP #$02 BNE SELMD4MD1660 LDA #$02 STA MOTYPEMNEWSD    ;C='S NEW "STANDARD" LDA #$00 STA MOPO1 STA MOPO3 LDA #$20 STA MOPO2 STA MOPO4 RTSSELMD4 CMP #$03 BNE SELMD5MT1660       ;SAME MODEM, BUT LDA #$03    ;WITH CARR. DETECT STA MOTYPE JMP MNEWSDSELMD5 CMP #$04 BNE SELMD6MP1064       ;_THIS MODEM SUCKS! LDA #$04 STA MOTYPE LDA #$7E STA MOPO1 STA MOPO3 LDA #$5E STA MOPO2 STA MOPO4 RTSSELMD6 CMP #$05 BNE PARADMHAYESM      ;1670/HAYES COMPAT LDA #$05 STA MOTYPE JMP MNEWSDPARADM LDA #$06 STA MOTYPE JMP MNEWSD;DISNMI PHA TXA PHA TYA PHA LDA #$7F STA $DD0D LDY $DD0DDONNMI JMP $FE72QUITTM JSR DECODE LDA #$37 STA $01 LDA #$FE PHA LDA #$65 PHA RTS          ;R/S RESTOREDECODE LDA #0 STA LOCAT LDA #>STADEC STA LOCAT+1 LDY #<STADECDECO1  LDA (LOCAT),Y EOR #$AA STA (LOCAT),Y INY BNE DECO2 INC LOCAT+1DECO2 CPY #<QUITTM BNE DECO1 LDA LOCAT+1 CMP #>QUITTM BCC DECO1 LDA #>DECOEN STA LOCAT+1 LDY #<DECOENDECO3  LDA (LOCAT),Y EOR #$AA STA (LOCAT),Y INY BNE DECO4 INC LOCAT+1DECO4 CPY #<ENDALL BNE DECO3 LDA LOCAT+1 CMP #>ENDALL BCC DECO3 RTS.BYT 0DECOENVIEWMG LDA #<AMPAG1 LDY #>AMPAG1 JSR OUTSTR LDA #0 STA 198VIEWM1 LDA 198 BEQ VIEWM1 LDA #<AMPAG2 LDY #>AMPAG2 JSR OUTSTR LDA #0 STA 198VIEWM2 LDA 198 BEQ VIEWM2 RTS;PRWCMC LDA MACXRG AND #$C0 ASL A ROL A ROL A ASL A CLC ADC #'1' STA EDFKTX RTSEDTMTX .BYT $93,5,13,13,E,'DIT WHICH MACRO?',13.BYT 158,'(',C,T,CR,L,32,F,'1,',F,'3,',F,'5,',F,'7, OR ',CR,E,T,U,CR,N,32.BYT 'TO ABORT.) ',5,3,2,18,0EDTRTX .BYT 19,13,5,E,'DIT ',FEDFKTX .BYT '1 MACRO...<',C,T,CR,L,'-',CX,'> TO END:',13,13,13,13,0WCHMAC .BYT 0EDTMAC LDA #<EDTMTX LDY #>EDTMTX JSR OUTSTR JSR SAVECHEDTMLP  LDA 197 CMP #1  ;RETURN BNE EDTMC2EDTMAB  RTSEDTMC2 CMP #3 BCC EDTMLP CMP #7 BCS EDTMLP PHA JSR RESTCH PLA TAXEDTMC3 LDA 197 CMP #7 BCC EDTMC3 JSR PRMACX STA WCHMACEDTMEN LDA #0 STA 198 LDA #$93 JSR CHROUT LDA #0 STA $D020 STA $D021EDTSTR JSR PRWCMC LDA #<EDTRTX LDY #>EDTRTX JSR OUTSTR LDA #1 STA MACMDM STA CURSFL LDA WCHMAC STA MACXRG JSR RESTCH LDA #' ' JSR CHROUT LDA #157 JSR CHROUT JSR PRTMC0EDTINP JSR CURPRTEDTKEY JSR GETIN BEQ EDTKEY CMP #16 ;CTRL-P BEQ EDTMEN CMP #19    ;NO HOME OR CLR BEQ EDTKEY CMP #$93 BNE EDTKY1 LDX MACXRGEDTCLR LDA #0 STA MACMEM,X CPX WCHMAC BEQ EDTKY0 DEX JMP EDTCLREDTKY0 LDX WCHMAC STX MACXRG JMP EDTMENEDTKY1 CMP #24 ;CTRL-X BEQ EDTBYE CMP #20 ;DEL BNE EDTKY2 LDA MACXRG CMP WCHMAC BEQ EDTKEY TAX JSR EDTDEL BCS EDTMEN LDA MACXRG AND #$3F CMP #$3F BNE EDTKEY JMP EDTMENEDTKY2 LDX 214 CPX #23 BCS EDTKEY CPX #3 BCC EDTKEYEDTKY3 LDX MACXRG CPX #255 BCS EDTKEY STA MACMEM,X PHA TXA CMP WCHMAC BEQ EDTKY4 AND #$3F BNE EDTKY4 PLA JSR BELL JMP EDTMENEDTKY4 INC MACXRG JSR CUROFF PLA JSR CTRLCK BCC EDTKY5 JMP EDTINPEDTKY5 JSR CHROUT JSR QIMOFF JMP EDTINPEDTBYE  LDX MACXRG LDA #0 STA MACMEM,X RTSMACRVS .BYT 146MACCTY .BYT 10MACCOL .BYT 5MACCAS .BYT 14MACBKG .BYT 0EDTDEL LDA #146 STA MACRVS LDA #10 STA MACCTY LDA #5 STA MACCOL LDA #14 STA MACCAS LDA #0 STA MACBKG LDA MACMEM-1,X CMP #'_' BEQ EDTDE2 AND #$7F CMP #' ' BCC EDTDE0 JMP EDTDLEEDTDE0 CMP #17 BEQ EDTDE1 CMP #29 BNE EDTDE3EDTDE1  LDA MACMEM-1,XEDTDEO  EOR #$80 JMP EDTDLNEDTDE2 LDA #148 JSR EDPRRV LDA #29 JMP EDTDLNEDTDE3 LDA MACMEM-1,X CMP #148 BNE EDTDE4 LDA #29 JSR EDPRRV LDA #148 BNE EDTDEOEDTDE4  JSR EDTCOK BMI EDTDE7 LDX MACXRG LDA MACMEM-2,X STA MACBKGEDTDE5  DEX CPX WCHMAC BEQ EDTDE6 LDA MACMEM-1,X JSR EDTCOK BMI EDTDE5 LDY MACMEM-2,X CPY MACBKG BEQ EDTDCL CPY #2 BEQ EDTDE5 LDY MACBKG CPY #2 BEQ EDTDE5EDTDCL STA MACCOLEDTDE6 LDA MACBKG CMP #2 BNE EDTCLH STA LASTCH CPX WCHMAC BEQ EDTCLB LDA MACCOL JSR EDTCOK BMI EDTCLB TYA TAXEDTCLB STX $D020 STX $D021 JMP EDTDLAEDTCLH LDA #0 STA LASTCH LDA MACCOL JMP EDTDLNEDTDE7 CMP #10 BEQ EDTDE8 CMP #11 BNE EDTD12EDTDE8 LDX MACXRGEDTDE9 DEX CPX WCHMAC BEQ EDTD11 LDA MACMEM-1,X CMP #10 BEQ EDTD10 CMP #11 BNE EDTDE9EDTD10  STA MACCTYEDTD11  LDA MACCTY JMP EDTDLNEDTD12  AND #$7F CMP #18 BNE EDTD15 LDX MACXRGEDTD13  DEX CPX WCHMAC BEQ EDTD14 LDA MACMEM-1,X AND #$7F CMP #18 BNE EDTD13 LDA MACMEM-1,X STA MACRVSEDTD14  LDA MACRVS AND #$80 EOR #$80 STA 199 LDA MACRVS JMP EDTDLNEDTD15 CMP #12 BEQ EDTD16 CMP #14 BEQ EDTD16 CMP #21 BNE EDTD19EDTD16 LDX MACXRGEDTDLC DEX CPX WCHMAC BEQ EDTD18 LDA MACMEM-1,X CMP #12 BEQ EDTD17 CMP #14 BEQ EDTD17 CMP #21 BNE EDTDLCEDTD17 STA MACCASEDTD18 LDA MACCAS JMP EDTDLNEDTD19 CMP #$0D BNE EDTDLA LDA #0 STA 199 LDA #146 JSR EDPRRV DEC MACXRG LDX MACXRG LDA #0 STA MACMEM,X SEC RTSEDTDLE LDA #20 JSR EDPRRV LDA #148EDTDLN JSR EDPRRVEDTDLA DEC MACXRG LDX MACXRG LDA #0 STA MACMEM,X CLC RTSEDPRRV STA $02 LDA 199 PHA LDA #0 STA 199 JSR CUROFF LDA $02 JSR CTRLCK BCS EDPRR2 JSR CHROUT JSR QIMOFFEDPRR2 PLA STA 199 JMP CURPRTEDTCOK LDY #15EDTCO2  CMP CLCODE,Y BEQ EDTCO3 DEY BPL EDTCO2EDTCO3 RTS;F7    ;TERMINAL PARAMS/DIAL LDA #0 STA $D020 STA $D021 LDA #<F7MTXT   ;PRINT F7 MENU LDY #>F7MTXT JSR OUTSTR LDA #<F7MTX2 LDY #>F7MTX2 JSR OUTSTRF7OPTS LDA #$00 STA $C6 JSR F7PARMF7CHOS LDA $A2 AND #$0F BNE F7CHGK LDA $A2 AND #$10 BEQ F7OPRT LDA #<PRRET LDY #>PRRET JSR OUTSTR JMP F7CHGKF7OPRT LDA #<PRRET2 LDY #>PRRET2 JSR OUTSTRF7CHGK JSR GETIN CMP #$00 BEQ F7CHOSF7CHS0 AND #$7F CMP #'A'   ;AUTO-DIAL OPT BNE F7CHS1 LDA BAUDRT STA BAUTMP LDA GRASFL STA GRATMP JMP PHBOOKF7CHS1 CMP #'B' BNE F7CHS2;BAUD RATE CHANGE INC BAUDRT LDA BAUDRT AND #$07 STA BAUDRT JSR BAUD JMP F7OPTSF7CHS2 CMP #'D' BNE F7CHS3;DUPLEX CHANGE LDA DUPLEX EOR #$01 STA DUPLEX JMP F7OPTSF7CHS3 CMP #'M' BNE F7CHSP;CHANGE MODEM TYPE INC MOTYPE LDA MOTYPE CMP #$07 BCC INCMOD LDA #$00 STA MOTYPEINCMOD JSR SELMDM JMP F7OPTSF7CHSP CMP #'P' BNE F7CHS4 LDA PROTOC EOR #1 AND #1 STA PROTOC JMP F7OPTSF7CHS4 CMP #'Q' BNE F7CHS5 JMP QUITTMF7CHS5 CMP #'*' BNE F7CHS6 LDA TONPUL EOR #$01 STA TONPUL JMP F7OPTSF7CHS6 CMP #'S' BNE F7CHS7 JSR SVCONF JMP F7F7CHS7 CMP #'L' BNE F7CHS8 JSR LOCONF JMP F7F7CHS8 CMP #'E' BNE F7CHS9 JSR EDTMAC JMP F7F7CHS9 CMP #'V' BNE F7CHSA LDA VISAUT BEQ F7GBKK JSR VIEWMG JMP F7F7CHSA CMP #$0D BEQ F7CHSBF7GBKK JMP F7CHOSF7CHSB JMP TERM;SCRACF .BYT 'S0:',0SVCTXT .BYT $93,13,5,F,'ILENAME: ',0CONFFN .BYT 'CCGMS/PHONE',0F7THOB .BYT 2F7MTXT .BYT $93,16,14,5,'   ',D,'IALER/',CP,'ARAMETERS',13 .BYT 31,'   ',163,163,163,163,163,163,163,163,163,163,163,163,163,163 .BYT 163,163,163,13,5F7MTX1 .BYT 16.BYT 32,2,'AUTO-',D,'IALER/',CP,'HONE ',B,'OOK',13,13.BYT 32,2,'BAUD ',CR,'ATE   -',13,13.BYT 32,2,'DUPLEX      -',13,13.BYT 32,2,'MODEM ',T,'YPE  -',13,13.BYT 32,2,'PROTOCOL    -',13,13.BYT 32,2,'EDIT ',M,'ACROS',13,13.BYT 32,2,'LOAD/',2,'SAVE ',CP,'HONE ',B,'OOK & ',C,'ONFIG.',13,13VISAUT .BYT 16.BYT 32,2,'VIEW ',CA,'UTHOR''S ',M,'ESSAGE',13,13,0F7MTX2 .BYT 32,2,'QUIT - ',E,'XIT TO ',B,CA,CS,I,C,13PRRET .BYT 3,20,0,5,CP,'RESS <',158,18,CR,E,T,U,CR,N,146,5,'> TO ABORT.' .BYT 13,13,5,C,'ALL THE ',152,D,'IGITAL ',150,CP,158,CA,153,I,159,N .BYT 154,T,32,5,CP,'ALACE...',17,157,157,157,157,157,157,157 .BYT 30,'(',158,'817',30,')',158,'281',30,'-',158,'7009',5,145,13,0PRRET2 .BYT 3,20,7,159,CR,E,T,U,CR,N,13,0TTDTXT .BYT 3,8,31,18,161,42,182,146,T,'ONE ',0TTPTXT .BYT 3,8,31,18,161,42,182,146,CP,'ULSE',0TTNTXT .BYT 3,8,33,'      ',0;BPSSPD .BYT 44,1,94,1,144,1,194,1,244,1,38,2,176,4,96,9 ;RATESBDNTSC .BYT $94,$79,$B0,$A0,$00BDPAL  .BYT $94,$70,$8A,$A9,$9ABDRATI .BYT $72,$C3,$BB,$F3,$A8BDADDC .BYT $81,$02,$D0,$E5,$60PARABD .BYT '%S',0BAUD LDX MOTYPE CPX #$06 BNE BAUD0 JSR PRDSPDBAUD0 LDA BAUDRTBAUDST ASL A TAX LDA BPSSPD,X STA $02 LDA BPSSPD+1,X STA $03 LDY $02 LDA $03 JSR $B391  ;BAUD TO FAC1 LDA #<BDNTSC LDY #>BDNTSC LDX $02A6  ;NTSC/PAL FLG BEQ BAUD2 LDA #<BDPAL LDY #>BDPALBAUD2 JSR $BB0F  ;FAC1=FAC1/PTR JSR $BBCA  ;FAC1 TO $57 JSR $B7F7  ;TO Y/A STY BDOUTL STA BDOUTH LDY $02 LDA $03 CMP #>400 BCC BAUD2A BNE BAUD3 CPY #<400 BCS BAUD3BAUD2A LDA #$57 LDY #$00 JSR $BBA2 JMP BAUD4BAUD3 LDY $02 LDA $03 JSR $B391  ;BAUD TO FAC1 LDA #<BDRATI LDY #>BDRATI JSR $BA28  ;FAC1=FAC1*PTR LDA #<BDADDC LDY #>BDADDC JSR $B867  ;FAC1=FAC1+PTR LDA #$57 LDY #$00 JSR $BA28  ;FAC1=FAC1*STOREDBAUD4 JSR $B7F7  ;TO Y/A STY 665    ;TIMING CONST. STA 666 LDY BDOUTL LDA BDOUTH STY 661    ;NON-STD BPS STA 662 LSR 662 ROR 661 LDA 661 SEC SBC #100   ;B/2-100 STA 661 LDA 662 SBC #0 STA 662 LDA 667 STA 668 JMP OUTVEC ;CHANGE CHROUT VEC.PRDSPD LDA BAUDRT BEQ PRDSP2 CMP #$06 BEQ PRDSP2 RTSPRDSP2 EOR #$06 JSR BAUDSTPRDSP3 LDX #$05 JSR CHKOUT LDA #<PARABD LDY #>PARABD JSR OUTMOD LDA #' ' JSR CHROUT LDA #'1' LDX BAUDRT BEQ PRDSP4 LDA #'2'PRDSP4  JSR CHROUT LDA #$0D JSR CHROUT JMP CLRCHN;PRMOPT .BYT <OP1TXT,>OP1TXT,<OP2TXT,>OP2TXT,<OP3TXT,>OP3TXTPRMLEN .BYT 4,17,6OP1TXT .BYT F,'ULL',H,'ALF'OP2TXT .BYT '1650 COMPATIBLES ' .BYT H,E,CS,32,I,I,'/',M,'ITEY ',M,'O  1660/MODEM300    ' .BYT '1660 + ',C,D,'        ',M,CP,CP,' 1064         ' .BYT '1670/',H,'AYES       ',CP,'ARADYNE ',D,T,U,'     'OP3TXT .BYT CP,'UNTER',CX,M,'ODEM'PRMTAB LDA #$0D JSR CHROUT JSR CHROUT LDX #17 JMP OUTSPCPRMCLC TYA ASL A TAX LDA PRMOPT,X STA PRMADR+1 LDA PRMOPT+1,X STA PRMADR+2 RTSPRMPRT DEX BMI PRMPR2 LDA PRMADR+1 CLC ADC PRMLEN,Y STA PRMADR+1 LDA PRMADR+2 ADC #$00 STA PRMADR+2 BNE PRMPRTPRMPR2 INXPRMADR LDA OP1TXT,X JSR CHROUT INX TXA CMP PRMLEN,Y BNE PRMADR JMP PRMTAB;F7PARM LDA #19 JSR CHROUT LDA #1 STA 646 LDY F7THOBPRMLOP JSR PRMTAB DEY BNE PRMLOP JSR PRMCLC LDA BAUDRT ASL A TAX LDA BPSSPD+1,X PHA LDA BPSSPD,X TAX PLA JSR OUTNUM LDA #' ' JSR CHROUT JSR CHROUT JSR PRMTAB LDY #0 JSR PRMCLC LDX DUPLEX JSR PRMPRT INY JSR PRMCLC LDX MOTYPE JSR PRMPRT LDA MOTYPE CMP #$02 BCC NOTOGM CMP #$04 BEQ NOTOGMYSTOGM LDA TONPUL BEQ PLTOGM LDA #<TTDTXT LDY #>TTDTXT BNE PRTOGMPLTOGM  LDA #<TTPTXT LDY #>TTPTXTPRTOGM  JSR OUTSTR JSR PRMTAB LDY #2 JSR PRMCLC LDX PROTOC JMP PRMPRTNOTOGM  LDA #<TTNTXT LDY #>TTNTXT BNE PRTOGM;PRTVEC .BYT $CA,$F1OUTVEC  ;CHANGE CHROUT VEC. LDA $0326 CMP #<PRINTV BNE OUTV1 LDA $0327 CMP #>PRINTV BEQ OUTV2OUTV1 LDA $0326 STA PRTVEC LDA $0327 STA PRTVEC+1 LDA #<PRINTV STA $0326 LDA #>PRINTV STA $0327OUTV2 RTSPRINTV  ;NEW CHROUT W/CORRECTED PHA    ;MODEM TIMING LDA $9A CMP #$03 BNE OUTV3 PLA CMP #20 BNE OUTNDL LDA 646 PHA LDA #1 STA 646 LDA #20 JSR $E716 PLA STA 646 LDA #20 CLC RTSOUTNDL JMP (PRTVEC)OUTV3 BCC OUTV4 PLA JMP (PRTVEC)OUTV4 LSR A PLA STA $9E TXA PHA TYA PHA BCC OUTV9 JSR $F80D BNE OUTV5 JSR $F864 BCS OUTV7 LDA #$02 LDY #$00 STA ($B2),Y INY STY $A6OUTV5 LDA $9E STA ($B2),YOUTV6 CLCOUTV7 PLA TAY PLA TAX LDA $9E BCC OUTV8 LDA #$00OUTV8  RTSOUTV9  JSR OUTV11 JMP OUTV6OUTV10 JSR OUTV12OUTV11 LDY $029E INY CPY $029D BEQ OUTV10 STY $029E DEY LDA $9E STA ($F9),YOUTV12 LDA $02A1 LSR A BCS OUTV13 LDA #$10 STA $DD0E LDA BDOUTL STA $DD04 LDA BDOUTH STA $DD05 LDA #$81 JSR $EF3B JSR $EF06 LDA #$11 STA $DD0EOUTV13  RTS.FIL 5D.GS